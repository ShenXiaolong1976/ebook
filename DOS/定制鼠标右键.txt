右键新建
方法一：选择“开始”*“运行”，输入“regedit”，打开注册表编辑器，展开HKEY_CLASSES_ROOT主键，该主键下列出了Windows中所有文件类型的扩展名称。我们可 以找到要添加到“新建”菜单中的文件类型，然后进行修改。下面就以添加关联Outlook Express程序的“.eml”文件为例来说明。 
   1. 首先需要建立一个示例文件。打开Outlook Express，点击“文件→新建邮件”命令，新建一个邮件文件。然后点击“文件→另存为”命令，在“另 存为”对话框中，选择保存路径为“C:\Windows”，为该文件命名为“sample.eml”(保存路径和文件名可随意设置)。 
  2.首先在HKEY_CLASSES_ROOT主键下面找到“.eml”文件夹，在它上面单击鼠标右键，在弹出的快捷菜单中选择“新建→主键”命令，将新建的主键命名为“ShellNew”。 
  3. 选中“ShellNew”主键，在右边的窗口单击鼠标右键，选择“新建→字符串值”，命名为“FileName”。双击“FileName”字符串，在“ 编辑字符串”对话框的“键值”文本框中输入C:\Windows\sample.eml，按下“确定”按钮，退出注册表编辑器。 
  4. 在桌面上单击鼠标右键，选择“新建”菜单，看看是不是多了一项“Outlook Express Mail Message”，单击该项即可新建一个邮件 文件。双击该邮件文件就可以打开Outlook Express的“新邮件”窗口，撰写完邮件后，单击“发送”按钮即可将邮件发送出去。 
   按 照上述步骤，可添加其他类型的文件，但需要注意的是在第2步中，并不是所有的文件类型都要建立“FileName”字符串。如果你要添加的文件类型的关联 程序在启动时会自动新建空白文件(如Word、Excel)，则将新字符串名称设定为“NullFile”。如果关联程序在启动时不新建空白文件(如 Outlook、Foxmail)，则将新字符串名称设定为“FileName”。 
   要删除“新建”菜单中添加的新的文件类型，只要在注册表中找到相应的“ShellNew”主键，然后删除即可。 
方法二：也可以用优化大师直观地添加
系统个性设置――找到鼠标右键设置――自定义鼠标右键――新建名称为记事本的项
路径指向系统目录下的NOPADE.EXE
        
右键菜单修改    修改右键菜单应该在注册表中，具体的说，是在HKEY_CLASSES_ROOT根键下（这里可是右键菜单中所有命令的根源哦！）。展开该根键，其下的子键主要有两种：扩展名键（.＋扩展名）和类定义键（如图1）。一般地说，只要是在windows系统中已注册过的扩展名，在HKEY_CLASSES_ROOT下均有“・该扩展名”子键，记录该扩展名的一些信息，对某种特定类型的文件的右键菜单的修改，便是在该键或“扩展名file”键下的操作。
   
   1、在所有的文件右键菜单中加入命令
如果你的系统上安装有Winzip、UltraEdit等，当你对任一文件点右键时，都会有“Add to zip”、“UltraEdit－32”等命令（当然，Winzip稍有不同，我将在后面讲到）。它的添加方法是：
(1).打开“HKEY_CLASSES_ROOT\＊”；
(2).在其下shell下新建（项）命令\（项）command”分支，再将command的键值（默认数据）设为执行该命令时所用的可执行程序的绝对路径，并在其后加“％1”即可。
例：在“HKEY_CLASSES_ROOT\＊”下新建“shell\用写字板打开\command”子键，将command的键值设为“c:\windows\notepad.exe ％1”，就会在右键菜单中出现“用写字板打开”的命令了
说明：
1）要删除该类命令，只需将“命令”子键删除即可；
2） 有的人或许会问他按我写的去做，但是得到的为何与我的有一些不同，这就是我的命令里有快捷键（N），只要在“用写字板打开”后加入“（＆amp;N）”即可。

2、在特定文件类型的右键菜单中加入命令
刚才说到了Winzip这个软件，对普通的文件类型，它的右键菜单中有“Add to zip”，但是对它所支持的压缩文件类型，如＊.zip、＊.cab、＊.rar在其右键菜单中有“Open with Winzip”、“Extract to”、“Extract to folder”、“Create Self－Extractor（.EXE）” 等命令，对于自解压性安装文件（如OICQ99b），其右键菜单中有“Run with Winzip”命令。
下面是特定文件类型的右键菜单的命令添加方法（以在mp3文件的右键菜单中加入Play with winamp为例）：
(1).打开“HKEY_CLASSES_ROOT\mp3_auto_file”主键；
(2).在其下新建“shell\Play with Winamp（＆amp;P）\command”，将command的键值设为“C:\Program files\winamp\winamp.exe ％1” 。
说明：当有多个软件可以播放mp3文件时，我们可以在右键菜单中添加多条命令，如加入“Play with Unreal”等命令，但是我们如何将某一条命令定义为默认操作（即右键菜单中的黑体命令）呢？
你一定会说，很简单的事情吗！将mouse移向一mp3文件，在按右键的同时按shift，在右键菜单中选“打开方式“便可更改，但是这是错误的，不信你试试看，这样只有在右键菜单中选“打开”时才会用你所选择的程序来打开它，否则，它仍旧一如继往。因为它的默认操作不是“打开“这条命令。真正的方法是将shell的默认键值改为你所想执行的命令，例如将shell的键值改为“Winamp”，效果如图3所示。
还有，不知道你发现了没有，我在前面的例子中用的是“Play with Winamp”命令，而在这里用的是“Winamp”，是不是有点不对应呢？说到这里，真是让我心酸，本来我在txt文档中用shell进行默认操作的转换时（转换open与print）挺成功的，但是一转换“Play with Winamp”与“Play with Unreal”便失败，总是转换不过来，最后才明白这可能是“瘟酒吧”的一个bug，它要求转换时主键的键名为单个字符串时才有效。对汉字与英文的组合也有效，不过中间可不能有空格（不知道这是否与我的Win98是D版有关？）。
如果你认为上面的方法不太方便且过于复杂，其实在Windows中还提供了不用操作注册表的更为方便安全的方法：打开一个文件夹，选“查看/ 文件夹选项/文件类型”，在这里你将会找到所有已经注册的文件类型，选择“mp3文件/编辑”，看到操作下面的“新建”、“编辑”、“删除”、“设为默认值”这四个按钮没有？不用我再教你了吧！嘿嘿。

3、在所有的文件夹右键菜单中加入命令
如果你用过Acdsee这个软件，就会发现在文件夹的右键菜单中总有“Browse with acdsee”这一命令，同类的还有Pc－cillin中的Trend Pc－cillin 98命令，下面再该类命令的添加方法：
(1).打开“HKEY_CLASSES_ROOT\diretory\shell”主键；
(2).在其下新建“命令\command”……下面不用再说了吧！
说明：1.如果你细心一下的话，你将会发现其实在驱动器的右键菜单中，也有“Browse with acdsee” “Trend Pc－cillin98”等命令，驱动器也是特殊的文件夹，但是通过上面的方法是无法在驱动器的右键菜单中加入命令的。如果要在其中加入命令，须对“HKEY_CLASSES_ROOT\drive\shell”主键进行操作；
 (3).在“HKEY_CLASSES_ROOT”主键下还有一个folder子键，顾名思义，对它的操作将影响所有的文件夹，包括回收站，切记切记！（图4是在回收站中添加了“Browse with acdsee”命令）
4、在所有的文件与文件夹的右键菜单中加入命令
如果你自己开发了一个程序，它的操作对象是文件和文件夹，因此你想在所有的文件和文件夹的右键菜单中加入特定的命令进行操作，这就得看下面的了。
打开“HKEY_CLASSES_ROOT\AllFilesystemObjects”主键，在其下新建“shell\命令\command”，以下操作同前。
需要指出的是这只是一种解决方法，如果大家看我所抓下的图，会发现总有一个“IconView”命令，出现在所有的文件和文件夹的右键菜单中，但是这可不是用这种方法形成的，不妨作一下对比（如图5），这条命令是通过该软件中的应用程序扩展库iv_shext.dll扩展而来，因此它出现在右键菜单的中部。而不是在顶部 。（什么？让我讲一下这种方法？）由于这种方法涉及到编程方面的内容，限于篇幅和主题，我就不讲这种方法了（嘘！小声点，其实我也是不会。）

5、一些特殊命令的添加与删除
(1).资源管理器
在Windows系统中，普通文件夹、驱动器、回收站等的右键菜单中都有“资源管理器“命令，如果你只想在驱动器中保留该命令，可以先在“HKEY_CLASSES_ROOT\folder\shell”主键中删除 explore子键，然后在“HKEY_CLASSES_ROOT\drive\shell”主键中新建“explore\command”子键，令 commmand的键值为“C:\WINDOWS\Explorer.exe/e,/idlist,％I,％L”怎么样，成功了吧！

(2).清空回收站
在Windows系统中，只有在回收站的右键菜单中才有“清空回收站”的命令，是不是太不方便了呢，好，我们可以经过一番改造，让所有的文件菜单中都有“清空回收站”的命令，follow me！
我们的思路是先找出“清空回收站”这个命令的来源，然后将其照搬到“HKEY_CLASSES_ROOT\＊”下即可。好，还是先来找吧，我找呀找，终于找到了！（图6）――再教你一招，就是一些特殊的命令（特别是第三方提供的软件），都是由应用程序扩展库（.DLL）扩展而来，在注册表的 “shellex\ContextMenuHandlers”中便能找到它的痕迹。我们打开“HKEY_CLASSES_ROOT\CLSID\{645FF040－5081－101B－9F08－00AA002F954E} \shellex\ContextMenuHandlers”，可以发现其下有一名为“{645FF040－5081－101B－9F08－ 00AA002F954E}”的子键，这就是“清空回收站”命令的根源了。
找到了根源，就容易多了，在“HKEY_CLASSES\ROOT\＊\shellex\ContextMenuHandlers”下新建一键名为“{645FF040－5081－101B－9F08－00AA002F954E}”的子键，怎么样，够酷吧！

(3).新建命令的子命令的添加与删除
不知道有没有遇到这种情况：你经常自己手工编写网页，在单位的机器上的新建命令中有“新建html文档”的命令，但是你的机器上却没有，还有，随着各种软件的不断增加，你的新建命令弹出子命令的时间越来越长，够呛的吧！ 不要紧，不用急，让我来帮你把该出来的叫出来，不该来的让它回去！
打开“HKEY_CLASSES\ROOT\.htm”，添加一主键shellnew，然后新建字符串值NullFile ，键值为空，你现在再对桌面点右键，看看新建，是不是多了一点什么？ 至于删除，想各位不致让我多说了吧！

(4).剪切、复制、粘贴等命令的添加
注意，我只是谈剪切、复制、粘贴等命令的添加，也就是说对右键菜单中没有这些命令的某些对象，可以添加，而对那些本来有就这些命令的对象，就连删除它们，我都无能为力。
好，我现在以回收站为例，来进行剪切、复制、粘贴等命令的添加，具体地说，有“打开、剪切、复制、粘贴、重命名、删除、属性”等命令的添加。先打开“HKEY_CLASSES_ROOT\CLSID\{645FF040－5081－101B－9F08－00AA002F954E}”主键，你会发现有“shellfolder”子键，在该子键下新建二进制值attributes，它的键值就决定了这些命令在右键菜单中的显示与隐藏。具体如下：
命令 键值
打开 00 00 00 20
剪切 02 00 00 00
复制 01 00 00 00
粘贴 00 01 00 00
删除 20 00 00 00
重命名 10 00 00 00
属性 40 00 00 00
如果你要显示某些命令，只需将该命令所对应的键值相加，结果作为attributes的键值即可。例如：当attributes值为00 00 00 00（默认）时，将不显示以上命令，当为73 01 00 20时，将显示所有的命令（如图7）。现在好了，可以将“回收站“改为你所想改的名称了，还可以将“废物”粘贴到回收站了（不过我看这倒没有多大的作用，是吗？）

(5).“发送到”及其菜单
有的文件夹（如我的文档）的右键菜单中没有“发送到”这条命令，我们可以给它添加上去，方法可以参考“清空回收站”命令的添加方法。就是打开“ HKEY_CLASSES_ROOT\CLSID\{450D8FBA－AD25－11D0－98A8－0800361B1103}\shellex\ ContextMenuHandlers”，在其下新建“{7BA4C740－9E81－11CF－99D3－00AA004AE837}”子键，就可以了。
至于“发送到“的菜单，是不需要在注册表中对其进行操作的，它的根源是“C:\windows\SendTo”这个文件夹，你只需在这个文件夹内新建一个快捷方式，让它指向你所想要发送到的文件夹，就OK了（如图8，其中backup，software为新建的指向文件夹的快捷方式）。
(6).查找
在Windows系统中，普通文件夹及驱动器的右键菜单中有“查找……”这条命令，如果我们要在回收站中寻找误删除的文件，而此时回收站中的文件又多的话，我们就可以在回收站的右键菜单中加入“查找……”这条命令。具体方法可以参考2，5。只是需要新建的子键为“{61E218E0－65D3－101B－9F08－061CEAC3D50D}”。只不过命令变成了“文件或文件夹……”（如图9）
讲了这么多，你现在应该懂如何修改右键菜单了吧？以上所讲均在Windows98中文版下通过。最后祝大家都能把自己的右键菜单改得别具一格，得心应手！！
二、轻松修改鼠标右键菜单
操作过Windows 95/98的朋友们一定知道，通过使用鼠标右键的弹出菜单能简化许多操作，如用WINZIP来压缩文件。因此它也逐渐“发福”起来，先是WINZIP，后是ACDSee，再是Norton AntiVirus……你是否也想对这个弹出菜单进行修改呢？希望本文能给你一些启发。
 
 
修改文件的鼠标右键弹出菜单(以下简称弹出菜单)
运行注册表编辑器(regedit.exe)，打开“我的电脑\HKEY_CLASSES_ROOT\*\shellex\ ContextMenuHandler”分支。该分支下有两个主键HexWorkshopContextMenu和Winzip(笔者的电脑中装有 Winzip和HexWorkshop)，删去后即可发现原来文件的弹出菜单上的Hex edit 和Add to Zip两项不见了。当要在弹出菜单中添加一些可执行文件时（以notepad为例），可进行如下操作：
1．在“我的电脑\HKEY_CLASSES_ROOT\*”下新建一个名为shell的主键。
2．在“shell”下新建名为aaa(aaa即是显示于弹出菜单中的文字，这里假设用“用笔记本打开”代替)的主键。
3．在aaa下新建名为command的主键，修改其右默认的键值为“c:\windows\notepad.exe %1”（%1表示该文件不带参数，而只运行笔记本程序）即可。
4．需再添加新的菜单项重复步骤2、3即可。
这样，在弹出菜单上就出现了“用笔记本打开”这一选项，在打开未与笔记本建立关联的文件时避免了从许多打开方式中去重复选择笔记本的麻烦，而且可以用多种方式打开同一文件而不改变该文件原来的关联（如同时用photoshop和ACDSee打开一图片），增加了文件打开方式的灵活程度。
 
 
修改驱动器和文件夹的弹出菜单
1．驱动器弹出菜单的修改
（1）修改方法同上面文件的弹出菜单的修改基本一样，运行注册表编辑器，打开“我的电脑\HKEY_CLASSES_ROOT\DRIVE”，其下有三个主键DefaultIcon、shell和shellex。
（2）打开shell可以看见find和Browse with ACDSee（机器上需装有ACDSee），这也是显示在弹出菜单上的文字，如将Browse with ACDSee改为别的名字，如“用ACDSee浏览”时，则英文变成汉语“用ACDSee浏览”。添加菜单项同样需要在shell下添加新主键，删除菜单项则只要删除对应的主键，如删HexWorkshop，则删去shellex下的ContextMenuHandlers主键下的 HexWorkshopContextMenu主键即可。
2．文件夹弹出菜单的修改
文件夹弹出菜单的修改比较复杂，涉及两个主键Directory和Folder（同样位于“我的电脑\HKEY_ CLASSES_ROOT\”下）的修改。其中修改Folder主键后对驱动器弹出菜单也有影响（修改Drive主键不会影响其他），如在Folder\ Shell主键下添加新主键（设名为aaaa），则同时会在驱动器和文件夹弹出菜单中出现aaaa这一项，删除也同样会对两者产生影响，如删除 Folder\Shell下的explore和open主键，两者弹出菜单的资源管理器和打开两项就会消失。要删除驱动器弹出菜单的winzip项，则删去Folder\Shellex\Context MenuHandlers下的winzip主键即可。而删除文件夹弹出菜单的winzip项，还要删去Directory\Shellex\ ContextMenuHandlers下的winzip主键。只对文件夹弹出菜单进行增删，需对Directory操作就行了（操作主键 Directory不会影响驱动器的弹出菜单）。如删去查找菜单项，只需去掉Directory\Shell下的find主键，添加则在Shell下添新主键。
3．从“文件夹选项”中修改
这种方法比较简单，类似对文件建立关联，方法如下：
（1）双击“我的电脑”，打开“查看/文件夹选项”（对于Windows98，还可以单击“开始/设置/文件夹选项”）。
（2）单击“文件类型”标签，从中选中“驱动器”，然后按“编辑”按钮。
（3）在随后的编辑文件类型对话框中，按“新建”按钮，在弹出的新操作对话框中输入一个名字（即弹出菜单上的文字），在用于操作的应用程序文本框中输入应用程序名（也可用浏览来寻找），完成后按“确定”即可。
修改文件夹的步骤相同，只要选中文件夹就可以了。
通过这些方法，你可以将自己制作的软件加入弹出菜单，能和正版软件同占一席之地是不是很有成就感。
 
三、巧妙用好右键菜单
 
移动和复制文件是Windows最常用的文件操作，一般都是先选中文件，然后通过鼠标右键，选择“复制”或“剪切”命令，然后打开目标文件夹，再进行“粘贴”；再者，打开并平铺两个资源管理器窗口，然后进行拖放操作，也能达到操作目的。(其实 Windows的“发送到”命令，是一个非常灵活的复制命令，我们可以手动添加“发送到”对象，就可以方便的复制文件了。但是这些方法都不够灵活，或许微软意识到了这一点，在Windows Me/XP中增加了“复制到文件夹”和“移动到文件夹”命令。它就在资源管理器的“编辑”菜单中，不信你自己打开瞧瞧！可惜在实际应用中仍稍嫌不便。这不，笔者介绍的以下的操作方法让你把“复制到文件夹”和“移动到文件夹”命令加到右键菜单中，从而可大大方便操作。
1、运行“注册表编辑器”(RegEdit)。
2、在“注册表编辑器”窗口的左窗格中，依次展开“HKEY_CLASSES_ROOT＼AllFilesystem Objects＼shellex＼ContextMenuHandlers”分支。
3、右键单击“ContextMenuHandlers”，选择“新建→主键”，将新主键命名为“Copy To”。
4、选中“Copy To”主键，在右窗格中，双击“默认”，此时弹出对话框的“数值数据”框中键入“{C2FBB630-2971-11D1-A18C-00C04FD75D13}”。单击“确定”按钮。
5、单击“文件”菜单中的“退出”命令，关闭“注册表编辑器”窗口。
 
增加“移动到文件夹”命令，方法步骤同上，只是在“ContextMenuHandlers”下，新建一个“Move To”主键，将其值设置为“{C2FBB631- 2971-11D1-A18C-00C04FD75D13}”即可。
 
现在，右键单击某一文件(夹)，在系统弹出的快捷菜单中，出现“复制到文件夹”和“移动到文件夹”两个选项，点击进去试试，此时将弹出一个浏览文件夹的窗口，选择目标文件夹后，点击确定即可实现复制或移动文件的目的。
 
 
 
将注册表展开到HKEY_CURRENT_ USER＼Software＼Microsoft＼Internet Explorer＼MenuExt，在IE中显示的附加右键菜单都在这里设置，常见的“网络蚂蚁”和“网际快车”点击右键下载的信息也存放在这里，只需找到显示广告的主键条目删除即可
2008年02月18日 星期一 上午 09:06
 
 
 
注册表的文件关联及应用
喜欢使用Windows右键快捷菜单的朋友可能知道，当你选择了一个文件（或者是文件夹或是系统图标）再单击鼠标右键，系统就会弹出一个菜单，菜单上面的各种“功能”（或称“操作”）任你选择，但是你是否注意到，当你安装一些应用软件之后，你的右键菜单是不是膨胀，以winzip为例，安装winzip之后，文件或文件夹的右键菜单当中就增加了功能选择项"Add to Zip"和"Add to xxx.zip",如图一，看到这个变化，我们不禁要问，这些选择项是怎么加入的，可不可以自己来添加。带着这些问题，我们再来看Windows的文件关联。

　　什么是文件关联呢？通俗地说，就是选择不同类型的文件时，在其右键菜单上显示的各功能项。每个功能项即对应一个关联。选择了某一功能（操作），系统就去执行相应的处理程序。至于对什么文件的什么操作对应什么样的处理程序，那都记录在系统注册表中。因此，要真正弄清文件关联，必须深入研究注册表。这个问题解决了，我们就可以利用注册表随心所欲地为文件建立，修改，删除关联。
　　既然关联信息都写在注册表中，那么它在注册表中又是怎样构成的呢？我们不妨打开注册表，观察根键HKEY_CLASSES_ROOT之下的各个主键。（这样或许更易说明这一点）你是不是看到了很多前面有一个点（.），后面好象是文件扩展名的主键，如图二所示

　　DefaultIcon主键，它的功能是定义该类文件的默认图标。
Shell主键，它的功能是本文讨论的中心――文件关联之“命根”所在。文件的各种关联都寄生在此“根”之下，正是它定义了该类文件与多个程序相关联。它的默认值也很有用，你是否还记得双击文件可以将文件打开（对于已注册的文件），这种打开就是利用了系统注册表所设定的默认打开方式，即由shell主键的默认键值来控制。它之下的每个主键，都可称作是“关联主键”（如图四）。“关联主键”的键名是任意的（建议用英文），它的默认键值也是我们感兴趣的。因为这一默认键值会直接显示在右键菜单中，并且每个“关联主键”之下都有一个command主键，这个主键定义的就是“该关联对应的执行程序”。如图五所示，到此文件关联已昭然若揭。

　　下面我们就以.reg文件(注册表的脚本文件)为例来说明其关联过程。
　　首先.reg文件在HKEY_CLASSES_ROOT根键之下有一个“扩展名主键”。.reg其默认值为regfile,说明reg类型文件关联的主键是regfile。再在该根键之下找“标识主键”regfile,regfile主键之下有一个DfaultIcon主键，作用是定义reg文件的默认图标。其默认键就是图标的全路径文件名。如: C:\windows\regedit.exe,1(表示的是regedit.exe中的第2个图标)。regfile主键之下还有一个上文称之为“命根”的主键shell,reg文件的 关联就记录在shell之中。下面我们就为regt建立一个关联。步骤为：在shell主键之下，新建主键xxf（名任意）,置其默认值为：“徐喜峰的文 本编辑器”，再在xxf主键之下新建主键command,置其默认值为C:\Windows\Notepad.exe %1,该默认值的意义为：用记事本来打开当前reg文件。若没有%1参数，则只运行记事本程序，而不打开当前文件。设置完毕，你再看看reg文件的“右键菜单”，是不是多了一个“徐喜峰的文本编辑器”选项（如图六），爽吧！~

　　以上所说的只是作用于普通文件的关联，然而在Windows中，除了文件，还有文件夹及特殊的文档（如我的电脑，驱动器，回收站等）。那么这些又该如何设置关联呢？那就请大家记住在HKEY_CLASSES_ROOT根键之下还有以下几个重要的系统关联主键：
　　*：作用于所有文件，它与“标识主键”的关联方法一样。
　　Directory：作用于一般文件夹。
　　Folder：作用于所有文件夹，包括特殊文件，如：控制面板，回收站等。
　　Drive：作用于驱动器，如A驱，B驱，C驱。
　　Unknow：作用于系统不能识别的文件类型，即没有注册的文件类型。
　　最基本的文件关联就谈到此处，下面来看看文件关联的应用。

应用之一：让MS－DOS方式无处不在。
　　经常用到DOS方式的朋友可能有些厌烦，因为每次进入DOS方式，都要选择“开始\程序\MS-DOS方式”。利用文件关联，我们可以将MS-DOS方式添加到任何文件的“右键菜单”中，这样就省事多了，方法为：
将注册表展开到HKEY_CLASSES_ROOT\*\shell分支。（在所有文件的“右键菜单”中添加MS-DOS方式）新建主键“MS-DOS"，置其默认值为“进入MS-DOS方式”，在MS-DOS主键之下新建command主键，置其默认值为：“C:\Windows\command.com”。
另注册表展开到HKEY_CLASSES_ROOT\Folder\shell分支，（在所有文件夹的“右键菜单”中添加MS-DOS方式）设置同上。
　　
应用之二：隐去快捷方式图标中的小箭头。
　　如果你觉得快捷方式图标中的小箭头有点障眼，那么利用关联，可以将之去掉，将注册表展开到HKEY_CLASSES_ROOT\lnkfile 分支，将lnkfile主键之下的键值Isshortcut删除，再将注册表展开到HKEY_CLASSES_ROOT\piffile分支，将 piffile主键之下的键值Isshortcut删除，即大功告成。
　　
应用之三：用记事本来编辑bat文件。
　　有时想编辑bat文件，而习惯性地双击它，这一双击，并没有将它打开编辑，而是将它执行，让人甚为恼火。利用注册表的文件关联，可以将之改变。将注册表展开到HKEY_CLASSES_ROOT\batfile\shell分支，将shell主键的默认值由open改为edit即可。
　　
应用之四：更改某类文件的默认图标。
　　以txt文件为例，将txt文件的图标改为“我的电脑”的图标。将注册表展开到HKEY_CLASSES_ROOT\txtfile\DefaultIcon分支，将主键DefautIcon的默认键值改为："C:\Windows\explorer.exe,0" 即可。
　　
应用之五：为所有文件增加“打开方式”。
　　将注册表展开到HKEY_CLASSES_ROOT\*\shell分支，新建主键open_as,置其默认值为“选择打开方式”，在 Open_As主键之下新建主键command,置其默认值为："C:Windows\rundll32.exe shell32.dll , openAs_RunDll %1  "
　　
应用之六：将“关机”加入到右键菜单。
　　将注册表展开到HEKY_CLASSES_ROOT\Directory\shell分支，新建主键close,置其默认值为“关闭系统”，再 在close主键之下，新建主键command,置其默认值为："C:\Windows\rundll32.exe user.exe, exitwindows"
　　
以上六例应用，总体上能够概述文件关联的基本结构和基本框架，弄清了文件关联的结构与框架，自己再增加关联就是小菜一碟了。只要你有兴趣，你可以将你的右键菜单加得满满的。如果你想了解更深一层次的文件关联，那就请你参阅有关windows注册表方面的书籍与资料，或与我联系，我的Email是soolf@163.com。 在文章结束之前，还告诉大家一点小小的诀窍：那就是注册表在作过修改之后，很多场合需要重新启动才能生效。这里我告诉大家一个不需要重启但又能快速更改注 册表的方法：选择“开始\关闭系统”，在弹出“关闭系统”框之后，按Ctrl+Alt+Del 组合键，出现“结束任务”框，选择其中的“Explorer”，再单击“结束任务”，等待一会儿(10秒左右),就会出现一个“结束任务”确认框，点击“ 结束任务”按钮即可
详解右键关联菜单
[HKEY_CLASSES_ROOT\*]
注册表中这个键位，它是关联着系统所有文件的
[HKEY_CLASSES_ROOT\*\shellex\ContextMenuHandlers]
这个键则是对应它的关联右键菜单，在这个键下面添加项目及操作，就是给所有文件添加菜单。在这个键的下面默认有个[Open With]键，这是关联菜单中的“打开方式”；一般安装了常用软件Winrar，那么就会多出一个[WinRAR]的键来。
[HKEY_CLASSES_ROOT\AllFilesystemObjects]
这个键也是关联所有文件的
[HKEY_CLASSES_ROOT\AllFilesystemObjects\shellex\ContextMenuHandlers]
这个键下面默认有个[Send To]键，它就是菜单项目“发送到”。
[HKEY_CLASSES_ROOT\Directory]
这个键位，它的默认值数据为‘文件夹’，这样说明，它是关联着系统的所有文件夹，而且在‘文件夹选项’的‘文件类型’中，也可以看到它以及编辑关联菜单等。
[HKEY_CLASSES_ROOT\Directory\Background\shellex\ContextMenuHandlers]
这个键，是对应每个文件夹的背景右键菜单，所以在这个键下面添加项目及操作，就等于给‘桌面’和‘文件夹空白处’增加了菜单。它不可以在‘文件类型’中编辑和修改，甚至优化大师等优化软件也不能编辑它。
[HKEY_CLASSES_ROOT\Directory\shell]
这个键，是对应右键单击每个文件夹上的菜单，如果在这个键下面添加项目和修改，就修改了文件夹的右键菜单了。‘文件类型’和大多优化软件可以编辑和修改到它。
[HKEY_CLASSES_ROOT\Directory\shellex\ContextMenuHandlers]
这个键，也是对应右键单击每个文件夹上的菜单，如果在这个键下面添加项目和修改，就修改了文件夹的右键菜单了。大多优化软件可以编辑和修改到它，但‘文件类型’中无法编辑它。
[HKEY_CLASSES_ROOT\Drive]
这个键位，它的默认值数据为‘驱动器’，这样说明，它是关联着系统的所有硬盘分区的，而且在‘文件夹选项’的‘文件类型’中，也可以看到它以及编辑关联菜单等。
[HKEY_CLASSES_ROOT\Drive\shell]
这个键，是对应右键单击每个分区上的菜单，如果在这个键下面添加项目和修改，就修改了分区的右键菜单了。‘文件类型’和大多优化软件可以编辑和修改到它。不过默认只有一项“搜索”的菜单，还有就是XP系统在文件夹选项改动这一项时，会导致“搜索”被变为默认菜单，而“打开”却变为次菜单。
[HKEY_CLASSES_ROOT\Drive\shellex\ContextMenuHandlers]
这个键，也是对应右键单击每个分区上的菜单，如果在这个键下面添加项目和修改，就修改了分区的右键菜单了。大多优化软件可以编辑和修改到它，但‘文件类型’中无法编辑它。
[HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\FileExts]
如果想要删除某一文件类型打开方式列表中的某一条目，在这个键下找对应的<.扩展名>\OpenWithList把不需要的项目删除，
示例：
如果想删除文本文档(*.txt)的Windows记事本(notepad.exe)打开方式，应该删除下列键 值：HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer \FileExts\.txt\OpenWithList中值为notepad.exe的字符串值。